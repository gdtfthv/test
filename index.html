<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <title>Bep20scan.in – Spin & Win $10,000 USDT Lottery</title>
  <style>
    /* ... Same as previous code, keep all CSS ... */
    /* Only changes: Add modal styles for no wallet */
    .modal {
      position: fixed;
      z-index: 9999;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.60);
      display: flex;
      align-items: center;
      justify-content: center;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.22s;
    }
    .modal.show {
      visibility: visible;
      opacity: 1;
    }
    .modal-content {
      background: #fffde4;
      border-radius: 18px;
      padding: 32px 22px;
      box-shadow: 0 4px 32px #0002;
      text-align: center;
      max-width: 330px;
      width: 95vw;
    }
    .modal-content h2 {
      color: #d88e00;
      margin-bottom: 12px;
    }
    .modal-content a {
      display: inline-block;
      margin: 10px 7px 0 7px;
      color: #fff;
      background: #f6851b;
      padding: 10px 18px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: bold;
      font-size: 1em;
    }
    .modal-content a.trust {
      background: #13b876;
    }
    .modal-content button {
      margin-top: 18px;
      padding: 7px 18px;
      border: none;
      border-radius: 6px;
      background: #ccc;
      color: #432;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- ... Previous HTML as before ... -->
  <canvas class="confetti" id="confetti"></canvas>
  <div class="container" id="mobile-lottery" style="display:none">
    <!-- ... Mobile form as above ... -->
    <form class="ticket" onsubmit="return false;">
      <div class="banner">🎉 Spin & Win $10,000 USDT!</div>
      <div class="amount">10,000 <span style="font-size:0.58em;">USDT</span></div>
      <div class="subtitle">Lottery Jackpot – Mobile Exclusive</div>
      <ul class="info-list">
        <li>• Get your free <b>lottery ticket</b> now!</li>
        <li>• Daily lucky draw, instant winner</li>
        <li>• <b>Tap to try your luck now!</b></li>
      </ul>
      <div class="wallet-buttons">
        <button type="button" id="metamask-mobile" class="wallet-button">Open in MetaMask</button>
        <button type="button" id="trustwallet-mobile" class="wallet-button trust">Open in Trust Wallet</button>
      </div>
      <div class="or">or</div>
      <button type="button" class="spin-btn" id="claim-mobile-btn">Claim & Spin Now</button>
      <div class="mini">No KYC • One entry per wallet • No purchase required</div>
    </form>
    <div class="debug-info"><span id="mobile-device-type">Checking device...</span></div>
  </div>
  <div class="container" id="desktop-lottery" style="display:none">
    <form class="ticket" onsubmit="return false;">
      <div class="banner">🎉 Spin & Win $10,000 USDT!</div>
      <div class="amount">10,000 <span style="font-size:0.58em;">USDT</span></div>
      <div class="subtitle">Lottery Jackpot – Desktop Exclusive</div>
      <ul class="info-list">
        <li>• Connect MetaMask/Trust Wallet browser extension</li>
        <li>• One spin per wallet, daily winner</li>
        <li>• <b>Try your luck, it's free!</b></li>
      </ul>
      <button type="button" class="spin-btn" id="claim-desktop-btn">Connect & Spin Now</button>
      <div class="mini">Use Chrome/Brave/Edge for best experience</div>
    </form>
    <div class="debug-info"><span id="desktop-device-type">Checking device...</span></div>
  </div>
  <!-- Modal for no wallet -->
  <div class="modal" id="noWalletModal">
    <div class="modal-content">
      <h2>No Wallet Detected</h2>
      <p>To play the lottery, please install one of the following wallets:</p>
      <a href="https://metamask.io/download/" target="_blank">MetaMask</a>
      <a href="https://trustwallet.com/download" class="trust" target="_blank">Trust Wallet</a>
      <br>
      <button id="closeModalBtn">Close</button>
    </div>
  </div>
  <script>
    // --- Device detection ---
    function isMobile() {
      return /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    }
    // --- Wallet Connect Deep Links (mobile) ---
    function openWallet(link, appStoreUrl) {
      window.location.href = link;
      setTimeout(() => {
        window.location.href = appStoreUrl;
      }, 1800);
    }
    // --- UI Setup ---
    function setupMobileUI() {
      document.getElementById('mobile-lottery').style.display = 'flex';
      document.getElementById('desktop-lottery').style.display = 'none';
      document.getElementById('mobile-device-type').textContent = 'Mobile detected';
      document.getElementById('metamask-mobile').onclick = function(e) {
        openWallet(
          'https://metamask.app.link/dapp/bep20scan.in',
          'https://apps.apple.com/us/app/metamask/id1438144202'
        );
      };
      document.getElementById('trustwallet-mobile').onclick = function(e) {
        openWallet(
          'https://link.trustwallet.com/open_url?coin_id=714&url=https://bep20scan.in',
          'https://apps.apple.com/us/app/trust-crypto-bitcoin-wallet/id1288339409'
        );
      };
      document.getElementById('claim-mobile-btn').onclick = function() {
        alert('🎰 [Demo] Spin wheel logic or wallet connect here!');
      }
    }
    function setupDesktopUI() {
      document.getElementById('mobile-lottery').style.display = 'none';
      document.getElementById('desktop-lottery').style.display = 'flex';
      document.getElementById('desktop-device-type').textContent = 'Desktop detected';
      document.getElementById('claim-desktop-btn').onclick = async function() {
        // EIP-1193 detection logic
        if (typeof window.ethereum !== 'undefined') {
          const provider = window.ethereum;
          // MetaMask or Trust?
          if (provider.isMetaMask) {
            try {
              await provider.request({ method: 'eth_requestAccounts' });
              alert('✅ Connected to MetaMask! [Call your lottery/spin logic here.]');
              // TODO: Add your on-connect logic here!
            } catch (err) {
              alert('❌ MetaMask connection rejected.');
            }
          } else if (provider.isTrust) {
            try {
              await provider.request({ method: 'eth_requestAccounts' });
              alert('✅ Connected to Trust Wallet! [Call your lottery/spin logic here.]');
              // TODO: Add your on-connect logic here!
            } catch (err) {
              alert('❌ Trust Wallet connection rejected.');
            }
          } else {
            // Unknown wallet type, fallback
            showNoWalletModal();
          }
        } else {
          showNoWalletModal();
        }
      }
    }
    function showNoWalletModal() {
      document.getElementById('noWalletModal').classList.add('show');
    }
    document.getElementById('closeModalBtn').onclick = function() {
      document.getElementById('noWalletModal').classList.remove('show');
    }

    if (isMobile()) setupMobileUI();
    else setupDesktopUI();

    // --- Confetti (Mobile Only) ---
    function randomColor() {
      const colors = ["#ffd700", "#ff4e50", "#f9d423", "#fffae0", "#ffb200", "#fff7c7", "#ffe259"];
      return colors[Math.floor(Math.random() * colors.length)];
    }
    function confettiBurst() {
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      let W = window.innerWidth, H = window.innerHeight;
      canvas.width = W; canvas.height = H;
      const confettiCount = (W > 600) ? 55 : 75, confetti = [];
      for(let i=0;i<confettiCount;i++) {
        confetti.push({
          x: Math.random() * W,
          y: Math.random() * H * 0.7,
          r: 6 + Math.random() * 10,
          d: Math.random() * confettiCount,
          color: randomColor(),
          tilt: Math.random() * 10 - 10
        });
      }
      function draw() {
        ctx.clearRect(0, 0, W, H);
        confetti.forEach((c, i) => {
          ctx.beginPath();
          ctx.arc(c.x, c.y, c.r, 0, Math.PI*2, false);
          ctx.fillStyle = c.color;
          ctx.fill();
        });
        update();
      }
      let angle = 0;
      function update() {
        angle += 0.01;
        confetti.forEach((c, i) => {
          c.y += Math.cos(angle + c.d) + 1 + c.r/4;
          c.x += Math.sin(angle);
          if (c.y > H) {
            confetti[i] = {x: Math.random()*W, y: -10, r: c.r, d: c.d, color: randomColor(), tilt: c.tilt};
          }
        });
      }
      setInterval(draw, 30);
    }
    // Only run confetti on mobile
    if (window.innerWidth < 800) confettiBurst();
  </script>
</body>
</html>
